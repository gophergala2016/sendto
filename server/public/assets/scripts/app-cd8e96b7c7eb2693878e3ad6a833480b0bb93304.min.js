DOM.Ready(function(){ActivateShowlinks();ActivatePackagelinks();ActivateMethodLinks();ActivateFilterFields();ActivatePagerlinks();ActivateMap();});function ActivateMethodLinks(){DOM.On('a[method="post"], a[method="delete"]','click',function(e){if(this.getAttribute('method')=='delete'){if(!confirm('Are you sure you want to delete this item, this action cannot be undone?')){return false;}}
var url=this.getAttribute('href');var redirect=this.getAttribute('data-redirect');DOM.Post(url,function(){if(redirect.length>0){window.location=redirect;}else{window.location.reload();}},function(){console.log("#error POST to"+url+"failed");});return false;});}
function ActivateFilterFields(){DOM.On('.filter-form .field select, .filter-form .field input','change',function(e){this.form.submit();});}
function ActivateShowlinks(){DOM.On('.show','click',function(e){var selector=this.getAttribute('href');DOM.Each(selector,function(el,i){if(el.className!='hidden'){el.className='hidden';}else{el.className=el.className.replace(/hidden/gi,'');}});return false;});}
function ActivatePackagelinks(){DOM.On('.feature_dot','click',function(e){var selector=this.getAttribute('href');DOM.Each(".package",function(el,i){el.className='package hidden';});DOM.First(selector).className='package';return false;});}
function ActivatePagerlinks(){DOM.On('.pager li a','click',function(e){DOM.ForEach(this.parentNode.parentNode.querySelectorAll('a'),function(el){el.className='';});this.className='selected';var el=DOM.First(this.getAttribute('href'));DOM.Hide("."+el.className.split(" ")[0]);el.style.display='block';e.preventDefault();return false;});}
function ActivateMap(){DOM.On('.contact_iframe_container','click',function(e){this.style.pointerEvents='none';});}
DOM.Ready(function(){Editable.Activate('.content-editable-toolbar');});var Editable=(function(){return{Activate:function(s){if(!DOM.Exists(s)){return;}
DOM.Each('.content-editable-toolbar',function(toolbar){toolbar.buttons=toolbar.querySelectorAll('a');var dataEditable=toolbar.getAttribute('data-editable');toolbar.editable=DOM.First(DOM.Format("#{0}-editable",dataEditable));toolbar.textarea=DOM.First(DOM.Format("#{0}-textarea",dataEditable));if(toolbar.editable===undefined){toolbar.editable=DOM.Nearest(toolbar,'.content-editable')[0];}
if(toolbar.textarea===undefined){toolbar.textarea=DOM.Nearest(toolbar,'.content-textarea')[0];}
toolbar.textarea.style.display='none';toolbar.textarea.form.addEventListener('submit',function(e){Editable.updateContent(toolbar.editable,toolbar.textarea,false);return false;});toolbar.editable.addEventListener('input',function(e){Editable.cleanHTMLElements(this);});DOM.ForEach(toolbar.buttons,function(el,i){el.addEventListener('click',function(e){var cmd=this.id;var insert="";switch(cmd){case"showCode":Editable.updateContent(toolbar.editable,toolbar.textarea,true);break;case"createLink":insert=prompt("Supply the web URL to link to");if(insert.indexOf('http')!==0){insert="http://"+insert;}
break;case"formatblock":insert=this.getAttribute('data-format');break;default:break;}
if(cmd.length>0){document.execCommand(cmd,false,insert);}
var sel=Editable.getSelectionParentElement();if(sel!==null){Editable.cleanAlign(cmd,sel);Editable.cleanHTMLElements(sel);sel.removeAttribute('style');}
return false;});});});},cleanAlign:function(cmd,el){switch(cmd){case"justifyCenter":if(sel.hasClass('align-center')){sel.removeClass('align-center');}else{sel.addClass('align-center');}
sel.removeClass('align-left').removeClass('align-right');sel.removeAttr('style');break;case"justifyLeft":if(sel.hasClass('align-left')){sel.removeClass('align-left');}else{sel.addClass('align-left');}
sel.removeClass('align-center').removeClass('align-right');sel.removeAttribute('style');break;case"justifyRight":if(sel.hasClass('align-right')){sel.removeClass('align-right');}else{sel.addClass('align-right');}
sel.removeClass('align-center').removeClass('align-left');sel.removeAttribute('style');break;}},cleanHTML:function(html){html=html.replace(/<\/?span>/gi,'');html=html.replace(/<\/?font [^>]*>/gi,'');html=html.replace(/&nbsp;</gi,' <');html=html.replace(/<p><\/p>/gi,'\n');html=html.replace(/<br><\/li>/gi,'<\/li>');html=html.replace(/<!--[\w\d\[\]\s<\/>:.!="*{};-]*-->/gi,'');html=html.replace(/ class\=\"MsoNormal\"/gi,'');html=html.replace(/<p><o:p> <\/o:p><\/p>/gi,'');html=html.replace(/><(li|ul|ol|p|h\d|\/ul|\/ol)>/gi,'>\n<$1>');return html;},cleanHTMLElements:function(el){DOM.ForEach(el.querySelectorAll('p, div, b, i, h1, h2, h3, h4, h5, h6'),function(e){e.removeAttribute('style');});DOM.ForEach(el.querySelectorAll('span'),function(e){e.removeAttribute('style');e.removeAttribute('lang');});DOM.ForEach(el.querySelectorAll('font'),function(e){e.removeAttribute('color');});},updateContent:function(editable,textarea,toggle){var html='';if(textarea.style.display!=='none'){html=textarea.value;editable.innerHTML=html;if(toggle){editable.style.display='';textarea.style.display='none';}}else{html=editable.innerHTML;html=Editable.cleanHTML(html);textarea.value=html;if(toggle){editable.style.display='none';textarea.style.display='';}}},getSelectionParentElement:function(){var p=null,sel;if(window.getSelection){sel=window.getSelection();if(sel.rangeCount){p=sel.getRangeAt(0).commonAncestorContainer;if(p.nodeType!=1){p=p.parentNode;}}}else if((sel=document.selection)&&sel.type!="Control"){p=sel.createRange().parentElement();}
return p;}};}());